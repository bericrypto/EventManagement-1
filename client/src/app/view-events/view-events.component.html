
<div class="view-events-bg coolvetica">
    <div class="view-events-header">
        <h2>Manage Events</h2>
    </div>
    <div class="view-events-content">
        <mat-card class="view-events-card">
            <mat-card-content>
                <form [formGroup]="itemForm" (ngSubmit)="searchEvent()" class="view-events-search-form">
                    <mat-form-field appearance="outline" class="view-events-search-field">
                        <mat-label>Search With ID or Title</mat-label>
                        <input matInput type="text" formControlName="searchTerm" placeholder="Search With ID or Title">
                    </mat-form-field>
                    <button mat-raised-button color="primary" type="submit">Search</button>
                </form>
                <div *ngIf="message" class="view-events-alert" [ngClass]="{'success': message.type === 'success', 'error': message.type === 'error'}">
                    {{ message.text }}
                </div>
            </mat-card-content>
        </mat-card>
        <mat-card class="view-events-card">
            <mat-card-content>
                <div class="view-events-controls">
                    <mat-form-field appearance="outline" class="view-events-control-field">
                        <mat-label>Sort By</mat-label>
                        <mat-select id="sort" (selectionChange)="onSortChange($event)">
                            <mat-option value="id">ID</mat-option>
                            <mat-option value="title">Title</mat-option>
                            <mat-option value="date">Date</mat-option>
                            <mat-option value="location">Location</mat-option>
                        </mat-select>
                    </mat-form-field>
                    <mat-form-field appearance="outline" class="view-events-control-field">
                        <mat-label>Filter Events</mat-label>
                        <mat-select id="filter" (selectionChange)="onFilterChange($event)">
                            <mat-option value="all">All Events</mat-option>
                            <mat-option value="past">Past Events</mat-option>
                            <mat-option value="today">Today's Events</mat-option>
                            <mat-option value="future">Future Events</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class="view-events-table-wrapper">
                    <table mat-table [dataSource]="paginatedEvents" class="view-events-table">
                        <ng-container matColumnDef="eventID">
                            <th mat-header-cell *matHeaderCellDef>ID</th>
                            <td mat-cell *matCellDef="let event">{{ event.eventID }}</td>
                        </ng-container>
                        <ng-container matColumnDef="title">
                            <th mat-header-cell *matHeaderCellDef>Title</th>
                            <td mat-cell *matCellDef="let event">{{ event.title }}</td>
                        </ng-container>
                        <ng-container matColumnDef="description">
                            <th mat-header-cell *matHeaderCellDef>Description</th>
                            <td mat-cell *matCellDef="let event">{{ event.description }}</td>
                        </ng-container>
                        <ng-container matColumnDef="dateTime">
                            <th mat-header-cell *matHeaderCellDef>Date</th>
                            <td mat-cell *matCellDef="let event">{{ event.dateTime | date:'medium' }}</td>
                        </ng-container>
                        <ng-container matColumnDef="location">
                            <th mat-header-cell *matHeaderCellDef>Location</th>
                            <td mat-cell *matCellDef="let event">{{ event.location }}</td>
                        </ng-container>
                        <ng-container matColumnDef="status">
                            <th mat-header-cell *matHeaderCellDef>Status</th>
                            <td mat-cell *matCellDef="let event">{{ event.status }}</td>
                        </ng-container>
                        <ng-container matColumnDef="action">
                            <th mat-header-cell *matHeaderCellDef>Action</th>
                            <td mat-cell *matCellDef="let event">
                                <button mat-stroked-button color="accent" (click)="edit(event)">Update</button>
                            </td>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="['eventID', 'title', 'description', 'dateTime', 'location', 'status', 'action']"></tr>
                        <tr mat-row *matRowDef="let row; columns: ['eventID', 'title', 'description', 'dateTime', 'location', 'status', 'action'];"></tr>
                    </table>
                </div>
                <div class="view-events-pagination">
                    <button mat-stroked-button color="accent" (click)="previousPage()" [disabled]="currentPage === 1">Previous</button>
                    <span>Page {{ currentPage }} of {{ totalPages }}</span>
                    <button mat-stroked-button color="accent" (click)="nextPage()" [disabled]="currentPage === totalPages">Next</button>
                </div>
            </mat-card-content>
        </mat-card>
        <mat-dialog-container *ngIf="isUpdate" class="view-events-dialog">
            <mat-card class="view-events-dialog-card">
                <mat-card-header>
                    <mat-card-title>Update Event</mat-card-title>
                </mat-card-header>
                <mat-card-content>
                    <form [formGroup]="itemForm" (ngSubmit)="onSubmit()">
                        <mat-form-field appearance="outline" class="view-events-dialog-field">
                            <mat-label>Title</mat-label>
                            <input matInput type="text" id="title" formControlName="title">
                            <mat-error *ngIf="itemForm.get('title')?.hasError('required') && itemForm.get('title')?.touched">Title is required.</mat-error>
                        </mat-form-field>
                        <mat-form-field appearance="outline" class="view-events-dialog-field">
                            <mat-label>Description</mat-label>
                            <input matInput type="text" id="description" formControlName="description">
                            <mat-error *ngIf="itemForm.get('description')?.hasError('required') && itemForm.get('description')?.touched">Description is required.</mat-error>
                        </mat-form-field>
                        <mat-form-field appearance="outline" class="view-events-dialog-field">
                            <mat-label>Date Time</mat-label>
                            <input matInput type="datetime-local" id="dateTime" formControlName="dateTime">
                            <mat-error *ngIf="itemForm.get('dateTime')?.hasError('required') && itemForm.get('dateTime')?.touched">Date and Time are required.</mat-error>
                        </mat-form-field>
                        <mat-form-field appearance="outline" class="view-events-dialog-field">
                            <mat-label>Location</mat-label>
                            <input matInput type="text" id="location" formControlName="location">
                            <mat-error *ngIf="itemForm.get('location')?.hasError('required') && itemForm.get('location')?.touched">Location is required.</mat-error>
                        </mat-form-field>
                        <mat-form-field appearance="outline" class="view-events-dialog-field">
                            <mat-label>Status</mat-label>
                            <mat-select id="status" formControlName="status" required>
                                <mat-option value="">Select status</mat-option>
                                <mat-option value="Scheduled">Scheduled</mat-option>
                                <mat-option value="Cancelled">Cancelled</mat-option>
                                <mat-option value="Completed">Completed</mat-option>
                            </mat-select>
                            <mat-error *ngIf="itemForm.get('status')?.hasError('required') && itemForm.get('status')?.touched">Status is required.</mat-error>
                        </mat-form-field>
                        <button mat-raised-button color="primary" type="submit">Update Event</button>
                    </form>
                </mat-card-content>
            </mat-card>
        </mat-dialog-container>
    </div>
</div>